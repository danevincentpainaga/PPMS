<md-sidenav class="md-sidenav-right" md-component-id="addUpdateUser" md-whiteframe="4" style="min-width: 65%;">
  <md-toolbar class="md-theme-light" style="min-height: 35px;max-height: 35px;">
    <md-icon class="material-icons"  ng-click="u.close()" style="position: absolute;left: 7px;top: 5px; cursor: pointer; background-color: #616dc3;">close</md-icon>
  </md-toolbar>
  <md-content layout-padding style="font-size: 13px;padding: 25px;">
    <form name="u.addUserForm">
      <div>
          <div layout="row" layout-xs="column" style="margin-bottom: 15px;">
              <div flex="13" class="image-holder">
                <div class="file-input">
                  <button ng-click="u.editPhoto()">edit</button>
                </div>
                <div layout="column" class="file-image">
                  <img ng-src="{{ u.photo | checkScholarPhoto }}" style="border-radius: 1em;">
                </div>
              </div>
              <md-input-container flex="">
                <label>Name</label>
                <input type="text" ng-model="u.name" name="name" required>
              </md-input-container>
              <md-input-container flex="">
                <label>Email</label>
                <input type="email" name="" ng-model="u.email" name="email" required>
              </md-input-container>
          </div>
          <div layout="row" layout-xs="column">
            <md-input-container flex="">
              <label>Password</label>
              <input type="password" ng-model="u.password" name="password" required>
            </md-input-container>
            <md-input-container flex="">
              <label>Confirm password</label>
              <input type="password" ng-model="u.c_password" name="c_password" required>
              <span ng-if="u.password_not_match" style="color: red;">Password does not match</span>
            </md-input-container>
            <md-input-container flex>
              <label>Role</label>
              <md-select ng-model="u.user_type" name="user_type" required>
                <md-option ng-repeat="user_type in u.user_type_list" ng-value="user_type"><em>{{ user_type }}</em></md-option>
              </md-select>
            </md-input-container>
          </div>
          <div layout="row" layout-xs="column">
            <md-input-container flex="35">
              <label>Status</label>
              <md-select ng-model="u.status" name="status" required>
                <md-option ng-repeat="status in u.status_list" ng-value="status"><em>{{ status }}</em></md-option>
              </md-select>
            </md-input-container>
          </div>
      </div>

      <p class="md-title">Add degree</p>
      <md-radio-group ng-model="u.selected_degree_options" name="selected_degree_options" ng-change="u.selectedDegreeOptions()" required>
        <div flex layout="row">
          <md-radio-button value="*" aria-label="All" class="md-primary">
            All
          </md-radio-button>
          <md-radio-button value="Custom" aria-label="Custom" class="md-primary">
            Custom
          </md-radio-button>
        </div>
      </md-radio-group>
      {{u.addUserForm.$invalid}}{{u.addUserForm.selectedDegree.$invalid}}
      <div ng-if="u.custom_degree">
        <label id="selectedDegree">Degree access, ex. (Undergraduate/Masters/Doctorate).</label>
<!--                    <md-contact-chips
              ng-model="u.selectedDegree"
              ng-change="u.onModelChange(u.selectedDegree)"
              md-contacts="u.queryDegree($query)"
              md-contact-name="degree"
              md-require-match="true"
              md-highlight-flags="i"
              placeholder="Type name to see matches"
              secondary-placeholder="Add Municipality"
              input-aria-label="Intended Recipients"
              name="selectedDegree"
              ng-required="true">
          </md-contact-chips> -->
        <md-chips ng-model="u.selectedDegree" name="selectedDegree" md-transform-chip="u.transformDegree($chip)" md-autocomplete-snap md-required-match="true" style="background: whitesmoke;margin-top: 5px;" ng-required="true">
          <md-autocomplete
              md-selected-item="u.selectedItem"
              md-search-text="u.searchDegree"
              md-items="item in u.queryDegree(u.searchDegree)"
              md-item-text="item"
              md-autoselect="true"
              md-required-match="true">
            <span md-highlight-text="u.searchDegree">{{item}}</span>
          </md-autocomplete>
          <md-chip-template>
            <span>
              <strong>{{$chip}}</strong>
            </span>
          </md-chip-template>
        </md-chips>
      </div>

      <p class="md-title">Add Municipality</p>
      <md-radio-group ng-model="u.selected_municipality_options" name="selected_municipality_options" ng-change="u.selectedMunicipalityOptions()" required>
        <div flex layout="row">
          <md-radio-button value="*" aria-label="All" class="md-primary">
            All
          </md-radio-button>
          <md-radio-button value="Custom" aria-label="Custom" class="md-primary">
            Custom
          </md-radio-button>
        </div>
      </md-radio-group>

      <div ng-if="u.custom_municipality">
        <label id="toLabel">Municipal access, ex. (Anini-y, Hamtic etc.).</label>
        <md-chips ng-model="u.selectedMunicipalities" name="selectedMunicipalities" md-transform-chip="u.transform($chip)" md-autocomplete-snap md-require-match="true" style="background: whitesmoke;margin-top: 5px;" ng-required="true">
          <md-autocomplete
              md-selected-item="u.selectedItems"
              md-search-text="u.searchMunicipality"
              md-items="item in u.queryMunicipality(u.searchMunicipality)"
              md-item-text="item.municipality"
              md-required-match="true">
            <span md-highlight-text="u.searchMunicipality">{{item.municipality}}</span>
          </md-autocomplete>
          <md-chip-template>
            <span>
              <strong>{{$chip}}</strong>
            </span>
          </md-chip-template>
        </md-chips>
      </div>

      <div style="text-align: right;margin-top: 3em;">
        <md-button class="md-raised md-primary"
          ng-click="u.saveUser()"
          ng-disabled="u.addUserForm.$invalid || u.addUserForm.selectedDegree.$invalid || u.addUserForm.selectedMunicipalities.$invalid || u.isSaving">{{ u.isSaving? 'saving...' : 'save' }}
        </md-button>
        <md-button
          class="md-raised"
          ng-disabled="u.isSaving">
          Clear
        </md-button>
      </div>
    </form>
  </md-content>
</md-sidenav>